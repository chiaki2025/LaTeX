\documentclass[8pt]{beamer}
\usepackage{tikz}
\usepackage[utf8]{vietnam}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{hyperref}
\usepackage{mathrsfs}
\usepackage{verbatim}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usetheme{Copenhagen}
\usecolortheme{dolphin}
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{headline}{}
\title[Chương 4: Thiết kế bộ lọc IIR] %optional
{Chương 4: Thiết kế bộ lọc IIR}
\subtitle{Xử lý tín hiệu số}
\author[Xử lý tín hiệu số] % (optional)
{Tín Vũ}
\date[VLC 2021] % (optional)
{tinvu1309@gmail.com}
\begin{document}
\frame{\titlepage}
\begin{frame}{Mục lục}
\tableofcontents
\end{frame}
\begin{frame}{Giới thiệu playlist}
\section{Giới thiệu playlist}
	\begin{itemize}
		\item Mình là Tín Vũ, hiện đang là sinh viên học tại Trường Đại học Công nghệ, Đại học Quốc gia Hà Nội. Mình tạo playlist video này để hỗ trợ các bạn học môn \textbf{Xử lý tín hiệu số}.
\item Khác với môn học tiên quyết \alert{Tín hiệu hệ thống} trước đó, bài giảng môn học này \textbf{hoàn toàn bám sát với đề cương và giáo trình nội bộ} của trường mình, nên các bạn trường khác cần phải lưu ý rất kĩ điều này.
\item Không chỉ dừng lại ở lý thuyết, playlist này \textbf{có bổ sung hướng dẫn lập trình cơ bản bằng GNU Octave/Matlab} để vẽ phổ tín hiệu, đáp ứng tần số và thiết kế bộ lọc.
\item Môn học này bao gồm \textbf{6 chương}, các chương đều liên quan rất chặt chẽ với nhau nên hãy học cẩn thận ngay từ \alert{Chương 0} để ôn thi cuối kì đỡ vất vả.
	\end{itemize}
\end{frame}
\begin{frame}{Tài liệu tham khảo}
\section{Tài liệu tham khảo}
\begin{itemize}
		\item Tài liệu tham khảo chính: Giáo trình Xử lý tín hiệu số (Nguyễn Linh Trung, Trần Đức Tân, Huỳnh Hữu Tuệ, ĐHCN, 2012).
		\item Tài liệu tham khảo phụ: Discrete-time Signal Processing (Alan V.Oppenheim, 2nd edition). 
	\end{itemize}
\end{frame}
\begin{frame}{Quy trình xử lý tín hiệu số}
\section{Quy trình xử lý tín hiệu số}
\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{1.jpg}
			\caption{DSP Learning Process}			\label{fig:re1}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\section{Thiết kế bộ lọc tương tự}
\begin{itemize}
	\item Ý tưởng thiết kế bộ lọc tương tự 
\end{itemize}
\subsection{Ý tưởng thiết kế bộ lọc tương tự}
\subsubsection{Bộ lọc thông thấp (LP)}
\begin{itemize}
\item[-] Bộ lọc thông thấp (LP)
\end{itemize}
Ta bắt đầu khảo sát từ sơ đồ mạch của bộ lọc thông thấp (lowpass filter - LP) bậc 1 đơn giản nhất:
\begin{figure}[h]
			\includegraphics[width=1\textwidth]{2.jpg}
			\caption{First order LP filter in time and Laplace domain}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Ta tìm hàm truyền của hai cấu trúc bộ lọc trên:
$$H(s)=\frac{\frac{1}{sC}}{R+\frac{1}{sC}}=\frac{1}{sRC+1}$$
$$H(s)=\frac{R}{R+sL}=\frac{1}{s\frac{L}{R}+1}$$
Ta đặt $\tau=RC$ hoặc $\tau=\frac{L}{R}$ là hằng số thời gian (time constant), ta thấy cả hai hàm truyền đều có chung dạng công thức: $$H(s)=\frac{1}{s\tau+1}$$
Ta muốn tìm đáp ứng tần số của hệ thống (bộ lọc là hệ thống nhân quả ổn định), thay $s=j\Omega$, ta có:
$$H(j\Omega)=\frac{1}{j\Omega\tau+1}\Rightarrow |H(j\Omega)|=\frac{1}{\sqrt{1+(\Omega\tau)^2}}$$
Hiển nhiên: $$H(j\Omega)=\frac{1}{j\Omega\tau+1}=\frac{1-j\Omega\tau}{1+(\Omega\tau)^2}\Rightarrow \angle H(j\Omega)=-\arctan{(\Omega\tau)}$$
Ta muốn biểu diễn đáp ứng tần số và đáp ứng pha của bộ lọc bằng \textbf{thang tuyến tính} và \textbf{thang dB}.
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{3.jpg}
			\caption{First order LP filter in linear and dB scale}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
	Ta thấy rằng bộ lọc thông thấp (từ giờ ta sẽ gọi tắt các bộ lọc theo thuật ngữ tiếng Anh) LP có độ lợi $G=-20$dB/decade (gain), và tín hiệu sau khi đi qua bộ lọc có hiện tượng \textbf{méo pha} được thể hiện rất rõ trên phổ. Đối với bộ lọc tương tự đơn giản, ta \alert{không thể khắc phục được hiện tượng méo pha}, ta chỉ có thể cải thiện giá trị \textbf{độ lợi G} mà thôi.

	\\Đối với bộ lọc tương tự đơn giản, ta định nghĩa khái niệm hằng số \textbf{tần số cắt} (cutoff frequency) chính là \alert{tần số biên}, tại giá trị này \textbf{năng lượng} của tín hiệu gốc bị \textbf{suy hao một nửa}. 
	\\ Nếu ta quy đổi theo thang dB, độ lợi $G_{c}$ tại tần số cắt là:
	$$G_{c}=20\log_{10}\left(\frac{1}{\sqrt{1+1}}\right)=-3\text{dB}$$
	Từ đáp ứng biên độ của bộ lọc LP bậc 1: $$|H(j\Omega)|=\frac{1}{\sqrt{1+(\Omega\tau)^2}}$$
	 Để giảm độ lợi $G$ xuống càng thấp càng tốt, ta thiết kế bộ lọc LP có bậc $n$ tổng quát có phương trình đáp ứng biên độ như sau:
	 $$|H(j\Omega)|=\frac{1}{\sqrt{1+(\Omega\tau)^{\alert{2n}}}}$$
	 Ta giới thiệu một vài sơ đồ mạch bộ lọc tương tự LP có bậc $n=2$ và dạng tổng quát (Cauer form). \textbf{Lưu ý: bậc bộ lọc bằng số phần tử dự trữ năng lượng trong mạch}.
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{4.jpg}
			\caption{Second order LP filter and higher order in Cauer form}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{5.jpg}
			\caption{Frequency response in dB scale of high order LP filter}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{itemize}
	\item[-] Bộ lọc thông cao (HP)
\end{itemize}
\subsubsection{Bộ lọc thông cao (HP)}
Cũng tương tự như bộ lọc LP, ta bắt đầu từ việc khảo sát bộ lọc HP bậc 1 đơn giản nhất có sơ đồ mạch như sau:
\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{6.jpg}
			\caption{First order HP filter in time and Laplace domain}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Ta cũng xây dựng được biểu thức hàm truyền của hai bộ lọc HP trên như sau:
$$H(s)=\frac{R}{R+\frac{1}{sC}}=\frac{sRC}{sRC+1}$$
$$H(s)=\frac{sL}{sL+R}=\frac{s\frac{L}{R}}{s\frac{L}{R}+1}$$
Đặt $\tau=RC$ hay $\tau=\frac{L}{R}$ là hằng số thời gian (time constant), ta thu được dạng hàm truyền của bộ lọc HP: $$H(s)=\frac{s\tau}{s\tau+1}$$
Hiển nhiên đây là hệ thống nhân quả ổn định, ta thay $s=j\Omega$ để tìm đáp ứng tần số của bộ lọc HP: $$H(j\Omega)=\frac{j\Omega\tau}{j\Omega\tau+1}\Rightarrow |H(j\Omega)|=\frac{\Omega\tau}{\sqrt{(\Omega\tau)^2+1}}=\frac{1}{\sqrt{1+\left(\frac{1}{\Omega\tau}\right)^2}}$$
Dễ thấy: $$H(j\Omega)=\frac{j\Omega\tau(1-j\Omega\tau)}{1+(\Omega\tau)^2}=\frac{(\Omega\tau)^2+j\Omega\tau}{1+(\Omega\tau)^2}\Rightarrow\angel \angle H(j\Omega)=\arctan{\frac{1}{\Omega\tau}}$$
Tương tự, ta cũng vẽ đồ thị đáp ứng biên độ và pha của bộ lọc HP bằng thang tuyến tính và thang dB.
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{7.jpg}
			\caption{First order HP filter in linear and dB scale}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Tương tự với bộ lọc LP, tần số cắt cũng nằm tại vị trí $-3$dB. Từ phương trình đáp ứng biên độ của bộ lọc HP bậc 1:  $$|H(j\Omega)|=\frac{1}{\sqrt{1+\left(\frac{1}{\Omega\tau}\right)^{2}}}$$
Ta cũng có phương trình đáp ứng biên độ của bộ lọc HP bậc $n$ tổng quát:
$$|H(j\Omega)|=\frac{1}{\sqrt{1+\left(\frac{1}{\Omega\tau}\right)^{2n}}}$$
Dễ thấy bộ lọc HP \alert{chính là phiên bản "đảo ngược"} của bộ lọc LP. Đây là nhận định cực kì quan trọng đóng vai trò cơ sở cho thuật toán thiết kế bộ lọc HP được nghiên cứu sau này.
\\ Ta giới thiệu một vài sơ đồ mạch tương tự cấu trúc bộ lọc HP bậc 2 và cao hơn như dưới đây. \textbf{Lưu ý: cũng giống như bộ lọc LP, bậc bộ lọc bằng số phần tử dự trữ năng lượng trong mạch.}
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{8.jpg}
			\caption{Second order HP filter and higher in Cauer form}			\label{fig:re2}
		\end{figure}


\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{9.jpg}
		\caption{Frequency response in dB scale of high order HP filter}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\subsubsection{Bộ lọc thông dải (BP)}
\begin{itemize}
	\item[-] Bộ lọc thông dải (BP)
\end{itemize}

\begin{figure}[h]
			\includegraphics[width=1.1\textwidth]{10.jpg}
		\caption{Bandpass filter}			\label{fig:re2}
		\end{figure}
\end{frame}
\begin{frame}{Thiểt kế bộ lọc tương tự}
\begin{itemize}
	\item[-] Bộ lọc chặn dải (BS)
\end{itemize}
\subsubsection{Bộ lọc chặn dải (BS)}
\begin{figure}[h]
			\includegraphics[width=1\textwidth]{11.jpg}
		\caption{Bandstop filter}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\subsection{Thiết kế bộ lọc LP}
\subsubsection{Bộ lọc Butterworth}
\begin{itemize}
	\item Thiết kế bộ lọc LP
\end{itemize}

Bộ lọc LP là loại bộ lọc \textbf{dễ thiết kế nhất} và là \alert{bộ lọc cơ sở để thiết kế các loại bộ lọc khác}. Ta giới thiệu 2 họ bộ lọc tương tự LP cơ bản nhất trong giới hạn chương trình học phần, đó là \textbf{bộ lọc Butterworth} và \textbf{bộ lọc Chebyshev}.
\begin{itemize}
	\item[-] Bộ lọc Butterworth
\end{itemize}
Bộ lọc LP Butterworth là loại bộ lọc đơn giản nhất có đáp ứng biên độ tổng quát:
$$|H(j\Omega)|=\frac{1}{\sqrt{1+\left(\frac{\Omega}{\Omega_{c}}\right)^{2n}}}\Rightarrow |H^{2}(j\Omega)|=\frac{1}{1+\left(\frac{\Omega}{\Omega_{c}}\right)^{2n}}$$
với $\Omega_{c}$ là \alert{tần số cắt của bộ lọc} tại độ lợi \alert{$G_{c}=-3$dB}, và $n$ là \textbf{bậc của bộ lọc}.
\\ Ta rất dễ nhận ra rằng, phương trình đáp ứng biên độ của họ bộ lọc LP Butterworth \textbf{giống} với dạng đáp ứng biên độ bộ lọc LP được thiết kế bằng các linh kiện điện tử thụ động đơn giản $R,L,C$ đã phân tích ở trên.
\\ Hay nói cách khác, phương trình đáp ứng biên độ của bộ lọc LP Butterworth \textbf{lấy ý tưởng từ phương pháp thiết kế bộ lọc LP thụ động đơn giản}.
\\ Ta biểu diễn đáp ứng biên độ của bộ lọc LP như sau:
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
			\includegraphics[width=1\textwidth]{12.jpg}
		\caption{Frequency response of Butterworth LP filter}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
	Bản chất của bài toán thiết kế bộ lọc là tìm \alert{hàm truyền $H(s)$} của hệ thống từ công thức đáp ứng tần số $|H(j\Omega)|$. Sau đó từ hàm truyền tìm được, người ta sẽ sử dụng các linh kiện điện tử phù hợp như $R,L,C$ hay Op-Amp để lắp ráp bộ lọc tương ứng.
\\ Để dễ dàng hình dung hơn về quy trình thiết kế bộ lọc, ta sẽ xét 3 ví dụ cơ bản sau:
\begin{enumerate}
	\item[1] Thiết kế bộ lọc Butterworth LP bậc 1 có tần số cắt $\alert{\Omega_{C}=1\;\text{(rad/s)}}$.
Từ phương trình đáp ứng tần số (thực ra đáp ứng biên độ là tên gọi chính xác hơn về thuật ngữ), ta có:
$$|H(j\Omega)|=\frac{1}{\sqrt{1+\Omega^2}}\Rightarrow |H^2(j\Omega)|=\frac{1}{1+\Omega^2}$$
Do bộ lọc là hệ thống ổn định, nên ta luôn có $\alert{s=j\Omega}$. Từ công thức tích liên hợp phức cơ bản, ta có kết quả rất quan trọng: $$\alert{|H^2(j\Omega)|=H(j\Omega)H(j\Omega)^*=H(j\Omega)H(-j\Omega)=H(s)H(-s)}$$
Thay toàn bộ $s$ vào phương trình đáp ứng tần số, ta thu được:
$$|H^2(j\Omega)|=\frac{1}{1+\Omega^2}\Rightarrow H(s)H(-s)=\frac{1}{1+\left(\frac{s}{j}\right)^2}=\frac{1}{-s^2+1}$$
Giải phương trình điểm cực của $H(s)H(-s)$, ta thu được $2$ điểm cực $s=\pm 1$, thế nhưng ta muốn tìm \alert{hàm truyền $H(s)$} có nghiệm cực sao cho đảm bảo \textbf{hệ thống ổn định}, tương đương với $\Re{(s)}<0$. Vậy ta chọn nghiệm cực $s=1$ và thu được hàm truyền: $$H(s)=\frac{1}{s+1}$$
	\end{enumerate}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
	\begin{enumerate}
		\item[2] Thiết kế bộ lọc Butterworth LP bậc 2 có tần số cắt $\alert{\Omega_{C}=1\;\text{(rad/s)}}$.  Thực hiện với quy trình tương tự, ta cũng có:

$$|H(j\Omega)|=\frac{1}{\sqrt{1+\Omega^4}}\Rightarrow |H^2(j\Omega)|=\frac{1}{1+\Omega^4}$$
Thay $s=j\Omega$, ta cũng có:

$$|H^2(j\Omega)|=\frac{1}{1+\Omega^4}\Rightarrow H(s)H(-s)=\frac{1}{1+\left(\frac{s}{j}\right)^4}=\frac{1}{s^4+1}$$
Từ phương trình nghiệm cực $s^4+1=0$, ta cần phải giải ra $2$ nghiệm phức thỏa mãn $\Re{(s)}<0$:
$$s^4+1=0\Rightarrow(s^2-j)(s^2+j)=0$$
\begin{equation*}
\begin{cases}
	s^2=j=\alert{e^{j\frac{\pi}{2}}}\\
	s^2=-j=\alert{e^{-j\frac{\pi}{2}}}\\
\end{cases}
\Rightarrow
\begin{cases}
	s=e^{j\frac{\pi}{4}}\\
	s=-e^{j\frac{\pi}{4}}\\

	s=e^{-j\frac{\pi}{4}}\\
	s=-e^{-j\frac{\pi}{4}}\\
\end{cases}
\end{equation*}
Chọn cặp nghiệm $s=-e^{\pm j\frac{\pi}{4}}=-0.707\pm 0.707$, dùng định lý Viete đảo, ta tìm được: $$H(s)=\frac{1}{s+\sqrt{2}s+1}$$
	\end{enumerate}
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}

	\begin{enumerate}
		\item[3] Thiết kế bộ lọc Butterworth LP bậc 3 có tần số cắt $\alert{\Omega_{C}=1\;\text{(rad/s)}}$.  Thực hiện với quy trình tương tự, ta cũng có:

$$|H(j\Omega)|=\frac{1}{\sqrt{1+\Omega^6}}\Rightarrow |H^2(j\Omega)|=\frac{1}{1+\Omega^6}$$
Thay $s=j\Omega$, ta cũng có:

$$|H^2(j\Omega)|=\frac{1}{1+\Omega^6}\Rightarrow H(s)H(-s)=\frac{1}{1+\left(\frac{s}{j}\right)^6}=\frac{1}{-s^6+1}$$
Từ phương trình nghiệm cực $-s^6+1=0$, ta cần phải giải ra $3$ nghiệm phức thỏa mãn $\Re{(s)}<0$:
$$-s^6+1=0\Rightarrow(s^2-1)(s^4+s^2+1)=0$$

\begin{equation*}
\begin{cases}
s=\pm 1\\
s^2=e^{\pm j\frac{2\pi}{3}}\\
\end{cases}
\Rightarrow
\begin{cases}
	s=\pm 1\\
	s=\pm e^{j\frac{\pi}{3}}\\
	s=\pm e^{-j\frac{\pi}{3}}\\
\end{cases}
\end{equation*}
Ta chọn 3 nghiệm $s=-1$, $s=-e^{\pm j\frac{\pi}{3}}$, dùng định lý Viete đảo, ta tìm được:
$$H(s)=\frac{1}{(s+1)(s^2+s+1)}$$
\end{enumerate}
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Tổng quát, bài toán thiết kế bộ lọc LP Butterworth bậc $n$ có $\Omega_{C}=1\;$(rad/s) tương đương với tìm đa thức có nghiệm \textbf{là nghiệm phần thực âm} của phương trình điểm cực:
$$\left(\frac{s}{j}\right)^{2n}=-1=e^{j\pi(2k-1)}\Rightarrow s^{2n}=e^{j\pi(2k-1)}e^{j\pi n}=e^{j\pi(n+2k-1)}$$
Vậy ta tìm được các nghiệm: $$s_{k}=e^{\frac{j\pi(n+2k-1)}{2n}}\;(k=1,2,\cdots,2n)$$
Chọn các nghiệm thỏa mãn $\Re{(s_{k})}<0$, ta thu được đa thức cực tương ứng của bộ lọc: $$\prod_{\Re{(s_{k})}<0}(s-s_{k})$$
Ta gọi đa thức cực trên là \textbf{đa thức Butterworth} có bậc $N$, được kí hiệu là $B_{N}(s)$.
\\ Các nhà toán học đã tìm được bảng \textbf{đa thức Butterworth} như sau:
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
			\includegraphics[width=0.7\textwidth]{phpe46ibx.png}
		\caption{Butterworth polynomials table}			\label{fig:re2}
		\end{figure}
Đương nhiên, bằng cách tính tay như đã trình bày ở 3 ví dụ trước, ta đều có thể tự nghiệm thu lại các đa thức Butterworth trong bảng trên. Thế nhưng, để cho tiện ta sẽ dùng thẳng bảng đa thức này luôn (đi thi bảng cũng được in vào đề).
\\ Ta thu được một kết quả quan trọng:  \\\textbf{\alert{Bộ lọc Butterworth LP bậc $N$ có tần số cắt chuẩn hóa (normalized frequency) $\Omega_{C}=1$ (rad/s) có hàm truyền:}} $$\alert{H(s)=\frac{1}{B_{N}(s)}}$$
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Ta mở rộng kết quả trên để tìm hàm truyền của bộ lọc Butterworth LP có \alert{tần số cắt $\Omega_{C}$ không chuẩn hóa}, dễ thấy từ đồ thị đáp ứng biên độ của hai bộ lọc:
\begin{figure}[h]
	\includegraphics[width=0.9\textwidth]{13.jpg}
	\caption{Design Butterworth LP filter}			\label{fig:re2}
		\end{figure}
		Ta dễ dàng nhận thấy rằng ta phải \textbf{định nghĩa thêm các kí hiệu mới tương ứng với các loại bộ lọc} để tránh nhầm lẫn và rối. Hay nói cách khác, các kí hiệu phải được \alert{hệ thống} một cách thuận tiện và chính xác.

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Đối với bộ lọc Butterworth LP có \alert{tần số cắt chuẩn hóa $\Omega_{C}=1$ (rad/s)}, ta kí hiệu:
\begin{enumerate}
	\item[1] Kí hiệu tần số góc: $\lambda$
	\item[2] Kí hiệu biến Laplace: $p$
	\item[3] Kí hiệu hàm truyền: $H_{N}(p)$
\end{enumerate}

Đối với bộ lọc Butterworth LP có \alert{tần số cắt không chuẩn hóa} (hay gọi là tần số cắt thường), ta kí hiệu:
\begin{enumerate}
	\item[1] Kí hiệu tần số góc: $\Omega$
	\item[2] Kí hiệu biến Laplace: $s$
	\item[3] Kí hiệu hàm truyền: $H(s)$
\end{enumerate}
Hệ thống kí hiệu này sẽ theo ta cho đến hết môn học, nên ta cần phải nắm rất chắc và không được nhầm lẫn ý nghĩa của chúng với nhau. Mình sẽ liên tục nhắc lại hệ thống kí hiệu này ở từng mục nhỏ.
\\Sử dụng hệ thống kí hiệu trên, ta thu được: 
$$\lambda=\frac{\Omega}{\Omega_{C}}\Rightarrow p=\frac{s}{\Omega_{C}}\Rightarrow H(s)=H_{N}\left(\frac{s}{\Omega_{C}}\right)$$
$$H_{N}(p)=\frac{1}{B_{N}(p)}$$
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
	Ví dụ: thiết kế bộ lọc Butterworth LP bậc 1 có tần số cắt $\Omega_{C}=4$ (rad/s).	\\ Từ bảng đa thức Butterworth, ta có: $$H_{N}(p)=\frac{1}{p+1}$$ Thay: $$p=\frac{s}{\Omega_{C}}$$ Ta thu được: $$H(s)=\frac{1}{\frac{s}{4}+1}=\frac{4}{s+4}$$
Hai thông số quan trọng nhất trong thiết kế là \textbf{bậc $N$} và \textbf{tần số cắt $\Omega_{C}$} của bộ lọc.
\\ Ta tuần tự "tổng quát hóa" bài toán thiết kế bộ lọc Butterworth LP như sau:
\\ \textbf{Biết bậc $N$ và $\Omega_{C}=1$ (rad/s)} $\rightarrow$ \textbf{Biết bậc $N$ và $\Omega_{C}$} $\rightarrow$ \textbf{Biết 4 thông số cơ bản của bộ lọc}
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Ví dụ: thiết kế bộ lọc Butterworth LP biết \textbf{4 thông số cơ bản} sau: $\Omega_{P}$, $G_{P}$, $\Omega_{S}$, $G_{S}$. Ta lần lượt biểu diễn các thông số này trên đồ thị đáp ứng tần số:
\begin{figure}[h]
	\includegraphics[width=0.9\textwidth]{14.jpg}
	\caption{General Butterworth LP filter frequency response}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
 Hiển nhiên ta có:
 \begin{equation*}
\begin{split}
	&G=20\log_{10}|H(j\Omega)|=10\log_{10}|H^2(j\Omega)|=-10\log_{10}\left(1+\left(\frac{\Omega}{\Omega_{C}}\right)^{2n}\right)\\
	&\Rightarrow \left(\frac{\Omega}{\Omega_{C}}\right)^{2n}=10^{\frac{-G}{10}}-1\Rightarrow \alert{\left(\frac{\Omega_{P}}{\Omega_{S}}\right)^{2n}=\frac{10^{\frac{-G_{P}}{10}}-1}{10^{\frac{-G_{S}}{10}}-1}}\\
	&\Rightarrow \alert{n=\log_{10}\left(\frac{10^{\frac{-G_{P}}{10}}-1}{10^{\frac{-G_{S}}{10}}-1}\right)\bigg/2\log_{10}\left(\frac{\Omega_{P}}{\Omega_{S}}\right)}\\
	&\textbf{Lưu ý chọn  $(n=\lceil n\rceil)$}\\
	&\left(\frac{\Omega}{\Omega_{C}}\right)^{2n}=10^{\frac{-G}{10}}-1\Rightarrow \left(\frac{\Omega_{P}}{\Omega_{C}}\right)^{2n}=10^{\frac{-G_{P}}{10}}-1 \Rightarrow \alert{\Omega_{C}=\frac{\Omega_{P}}{\left(10^{\frac{-G_{P}}{10}}-1\right)^{\frac{1}{2n}}}}
\end{split}
\end{equation*}
Nếu đề bài cho $A$, ta chỉ việc đổi dấu $A=-G$:
\begin{equation*}
\begin{split}
	\alert{n=\log_{10}\left(\frac{10^{\frac{A_{P}}{10}}-1}{10^{\frac{A_{S}}{10}}-1}\right)\bigg/2\log_{10}\left(\frac{\Omega_{P}}{\Omega_{S}}\right)}\\
\end{split}
\end{equation*}
$$\alert{\Omega_{C}=\frac{\Omega_{P}}{\left(10^{\frac{A_{P}}{10}}-1\right)^{\frac{1}{2n}}}}
$$
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
	Thiết kế một bộ lọc LP Butterworth thỏa mãn các đặc tả sau: $$0<\Omega<20\;\text{(rad/s)};\quad 0<A<2\;\text{(dB)}$$
$$\Omega>50\;\text{(rad/s)};\quad A>25\;\text{(dB)}$$
Từ đặc tả trên (và dựa vào phác họa đáp ứng tần số), ta dễ thấy $\Omega_{P}=20$, $\Omega_{S}=50$, $A_{P}=2$, $A_{S}=25$ (đối với các bài tập tính toán, ta có thể tạm thời lược bỏ không ghi thứ nguyên cho đơn giản).
Áp dụng công thức trên, ta có:
$$n=\log_{10}\left(\frac{10^{\frac{A_{P}}{10}}-1}{10^{\frac{A_{S}}{10}}-1}\right)\bigg/2\log_{10}\left(\frac{\Omega_{P}}{\Omega_{S}}\right)=3.43\Rightarrow \lceil n \rceil =4$$

$$\Omega_{C}=\frac{\Omega_{P}}{\left(10^{\frac{A_{P}}{10}}-1\right)^{\frac{1}{2n}}}=21.386$$
Từ bảng đa thức Butterworth, ta có: $$H_{N}(p)=\frac{1}{B_{4}(p)}$$
Thay: $$p=\frac{s}{\Omega_{C}}\Rightarrow H(s)=H_{N}\left(\frac{s}{\Omega_{C}}\right)$$
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
	Vậy ta thu được: $$H(s)=\frac{1}{B_{4}\left(\frac{s}{21.386}\right)}$$
	\begin{block}{Thuật toán thiết kế bộ lọc Butterworth LP}
	\begin{enumerate}
		\item[1] Xác định bậc $n$ và tần số cắt $\Omega_{C}$ của bộ lọc LP.
		\item[2] Tìm hàm truyền $H_{N}(p)$ bậc $n$ của bộ lọc thông thấp chuẩn hóa bằng bảng đa thức Butterworth.
		\item[3] Từ phép đổi biến Laplace: $$p=\frac{s}{\Omega_{c}}$$ Ta thu được hàm truyền $H(s)$ của bộ lọc LP.
	\end{enumerate}
\end{block}
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\subsubsection{Bộ lọc Chebyshev}
\begin{itemize}
	\item[-] Bộ lọc Chebyshev
\end{itemize}
Khác với bộ lọc Butterworth, bộ lọc Chebyshev \alert{là bộ lọc phức tạp} với quy trình lắp ráp khó, không thể được tạo ra chỉ từ tổ hợp các linh kiện điện tử đơn giản. Do giới hạn chương trình học phần, ta chỉ tìm hiểu bộ lọc Chebyshev loại I (hay gọi tắt là bộ lọc Chebyshev). Ta phác họa đáp ứng tần số của bộ lọc này như sau:
\begin{figure}[h]
	\includegraphics[width=1.1\textwidth]{15.jpg}
	\caption{Frequency response of Chebyshev LP filter}			\label{fig:re2}
		\end{figure}


\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Các nhà toán học đã xấp xỉ đáp ứng tần số $|H(j\Omega)|$ của bộ lọc Chebyshev như sau:
$$|H(j\Omega)|=\frac{\sqrt{\alert{\alpha}}}{\sqrt{1+\varepsilon^2 T_{N}^2\left(\righ\frac{\Omega}{\Omega_{C}}\right)}}\Rightarrow |H^2(j\Omega)|=\frac{\alert{\alpha}}{1+\varepsilon^2 T_{N}^2\left(\righ\frac{\Omega}{\Omega_{C}}\right)}$$

	Khác với bộ lọc Butterworth, \alert{tần số cắt $\Omega_{C}$} của bộ lọc Chebyshev được định nghĩa là \textbf{tần số biên của dải thông}, mà tại vị trí này ripples bắt đầu không còn nữa, và tín hiệu dần bị suy hao do tiến vào dải chuyển tiếp. 
	  \\ \alert{Chính vì thế nên độ suy hao tại tần số cắt của bộ lọc Chebyshev hoàn toàn phụ thuộc vào gợn sóng dải thông, chứ \textbf{không cố định tại điểm 3dB}}.
	\\$T_{N}(x)$ là đa thức Chebyshev bậc $N$ được định nghĩa như sau: $$\cos(Nx)=T_{N}(\cos(x))$$
	Ví dụ:
\begin{enumerate}
	\item[1] $$\cos(x)=\cos(x)\Rightarrow T_{1}(x)=x$$
	\item[2] $$\cos(2x)=2\cos^2(x)-1\Rightarrow T_{2}(x)=2x^2-1$$
	\item[3] $$\cos(3x)=4\cos^3(x)-3\cos(x)\Rightarrow T_{3}(x)=4x^3-3x$$
	\item[4] $$\cos(4x)=8\cos^4(x)-8\cos^2(x)+1\Rightarrow T_{4}(x)=8x^4-8x^2+1$$
\end{enumerate}
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
	\includegraphics[width=1\textwidth]{ves_basisf-chebyshev.png}
	\caption{Chebyshev Polinomials}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
	Đa thức Chebyshev $T_{N}(x)$ \textbf{gợn sóng rất mạnh} với $x\in[0,1]$, và tắt gợn sóng với $x>1$. Đây cũng chính là ý nghĩa toán học của khái niệm \textbf{tần số cắt} $\Omega_{C}$. Ta có thể dễ dàng thấy rằng với $0<\Omega<\Omega_{C}$, đáp ứng tần số gợn sóng trên dải thông và $\Omega>\Omega_{C}$ thì suy hao trên dải chuyển tiếp. 
	\\ Ta quan sát dải thông của bộ lọc và đồ thị đa thức Chebyshev trong khoảng $[0,1]$, dễ thấy:
$$0\leq T_{N}^2\left(\frac{\Omega}{\Omega_{C}}\right)\leq1$$
Vậy ta thu được khoảng biến thiên của đáp ứng tần số trong dải thông:
$$\frac{\alpha}{1+\varepsilon^2}\leq |H^2(j\Omega)|\leq\alpha$$
Ta tính được độ suy hao \textbf{cực đại} (attenuation) do hiện tượng gợn sóng (ripples) gây ra trong dải thông theo thang dB:
$$\textbf{max }A_{r}=10\log_{10}\frac{\alpha}{\frac{\alpha}{1+\varepsilon^2}}=10\log_{10}(1+\varepsilon^2)$$
Ta định nghĩa khái niệm độ gợn sóng $r$ (thang dB) như sau:
$$r=\textbf{max } A_{r}=10\log_{10}(1+\varepsilon^2)\Rightarrow \varepsilon^2=10^{\frac{r}{10}}-1$$
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Ta muốn thiết kế bộ lọc có độ khuếch đại DC, tức là $$|H(0)|=1$$
Từ các đa thức Chebyshev, ta thấy:
\begin{equation*}
\begin{cases}
T_{N}(0)=0\quad(\text{N odd})\\
T_{N}(0)=1\quad(\text{N even})\\
\end{cases}
\end{equation*}
Từ dạng của đáp ứng tần số $|H^2(j\Omega)|$, ta chọn $\alpha$ theo quy tắc để thỏa mãn điều kiện khuếch đại DC:

\begin{equation*}
\begin{cases}
\alpha=1\quad(\text{N odd})\\
\alpha=\varepsilon^2+1\quad(\text{N even})\\
\end{cases}
\end{equation*}
\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
\begin{figure}[h]
	\includegraphics[width=1\textwidth]{16.jpg}
	\caption{Chebyshev LP filter N odd order}			\label{fig:re2}
		\end{figure}

\end{frame}
\begin{frame}{Thiết kế bộ lọc tương tự}
Từ công thức đa thức Chebyshev: $$\cos(Nx)=T_{N}(\cos(x))$$
Ta đặt $\cos(x)=t$, hiển nhiên $|t|\leq 1$, biến đổi tương đương ta có:
$$\cos(Nx)=T_{N}(\cos(x))\Rightarrow T_{N}(t)=\cos{(N\arccos(t))}\quad (|t|\leq 1)$$
Với $|t|>1$, ta công nhận không chứng minh: $$T_{N}(t)=\cosh(N\text{ arccosh}{(t)})$$
\\ Ví dụ: thiết kế bộ lọc LP Chebyshev từ \textbf{4 thông số cơ bản} sau: $r, \Omega_{C}, A_{S},\Omega_{S}$
\end{frame}
\end{document}
